"use strict";(self.webpackChunkbit_brick_docs=self.webpackChunkbit_brick_docs||[]).push([[592],{3488:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>a});var i=n(4848),o=n(8453);const r={},s="yocto",l={id:"imx8mp/yocto",title:"yocto",description:"A Yocto Project build requires that some packages be installed for the build that are",source:"@site/docs/imx8mp/yocto.md",sourceDirName:"imx8mp",slug:"/imx8mp/yocto",permalink:"/bit-brick-docs/docs/imx8mp/yocto",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/imx8mp/yocto.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ubuntu",permalink:"/bit-brick-docs/docs/imx8mp/ubuntu"}},c={},a=[{value:"1.Installation required package",id:"1installation-required-package",level:2},{value:"2.Setting up the Repo utility",id:"2setting-up-the-repo-utility",level:2},{value:"3.Yocto Project Setup",id:"3yocto-project-setup",level:2},{value:"4.Building the Project",id:"4building-the-project",level:2},{value:"4.1 change uboot",id:"41-change-uboot",level:3},{value:"4.2 change kernel",id:"42-change-kernel",level:3},{value:"5.Burn Image to device",id:"5burn-image-to-device",level:2},{value:"5.1 Downloading UUU",id:"51-downloading-uuu",level:3},{value:"5.2 Using UUU",id:"52-using-uuu",level:3},{value:"FAQ",id:"faq",level:2},{value:"Q: How to modify the number of threads?",id:"q-how-to-modify-the-number-of-threads",level:3},{value:"Q: How to modify the size of the tmp partition?",id:"q-how-to-modify-the-size-of-the-tmp-partition",level:3},{value:"Q: How to compile the kernel separately?",id:"q-how-to-compile-the-kernel-separately",level:3},{value:"Q: Failure in installing package with apt",id:"q-failure-in-installing-package-with-apt",level:3}];function d(e){const t={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"yocto",children:"yocto"}),"\n",(0,i.jsx)(t.p,{children:"A Yocto Project build requires that some packages be installed for the build that are\ndocumented under the Yocto Project. Go to Yocto Project Quick Start and check for the\npackages that must be installed for your build machine."}),"\n",(0,i.jsx)(t.p,{children:"To get the Yocto Project expected behavior in a Linux Host Machine, the packages and\nutilities described below must be installed. An important consideration is the hard disk\nspace required in the host machine. For example, when building on a machine running\nUbuntu, the minimum hard disk space required is about 50 GB. It is recommended that at\nleast 120 GB is provided, which is enough to compile all backends together. For building\nmachine learning components, at least 250 GB is recommended."}),"\n",(0,i.jsx)(t.p,{children:"The recommended minimum Ubuntu version is 20.04 or later. The latest release supports\nChromium v91, which requires an increase to the ulimit (number of open files) to 4098.\nEssential Yocto Project host packages are:"}),"\n",(0,i.jsx)(t.h2,{id:"1installation-required-package",children:"1.Installation required package"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"$ sudo apt-get install gawk wget git-core diffstat unzip texinfo gcc-multilib build-essential chrpath socat cpio python python3 python3-pip python3-pexpect \nxz-utils debianutils iputils-ping python3-git python3-jinja2 libegl1-mesa libsdl1.2-dev \npylint3 xterm rsync curl zstd pzstd lz4c lz4 libssl-dev\n$ sudo locale-gen en_US.UTF-8\n"})}),"\n",(0,i.jsx)(t.h2,{id:"2setting-up-the-repo-utility",children:"2.Setting up the Repo utility"}),"\n",(0,i.jsx)(t.p,{children:"Repo is a tool built on top of Git that makes it easier to manage projects that contain\nmultiple repositories, which do not need to be on the same server. Repo complements\nvery well the layered nature of the Yocto Project, making it easier for users to add their\nown layers to the BSP.\nTo install the \u201crepo\u201d utility, perform these steps:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"2.1.  Create a bin folder in the home directory."}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"$ mkdir ~/bin (this step may not be needed if the bin folder\n already exists)\n$ curl https://storage.googleapis.com/git-repo-downloads/repo\n > ~/bin/repo\n$ chmod a+x ~/bin/repo\n"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"2.2 Add the following line to the .bashrc file to ensure that the ~/bin folder is in your\nPATH variable."}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"export PATH=~/bin:$PATH\n"})}),"\n",(0,i.jsx)(t.h2,{id:"3yocto-project-setup",children:"3.Yocto Project Setup"}),"\n",(0,i.jsx)(t.p,{children:"First, make sure that Git is set up properly with the commands below:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'$ git config --global user.name "Your Name"\n$ git config --global user.email "Your Email"\n$ git config --list\n'})}),"\n",(0,i.jsx)(t.p,{children:"The i.MX Yocto Project BSP Release directory contains a sources directory, which\ncontains the recipes used to build one or more build directories, and a set of scripts used\nto set up the environment.\nThe recipes used to build the project come from both the community and i.MX. The Yocto\nProject layers are downloaded to the sources directory. This sets up the recipes that are\nused to build the project.\nThe following example shows how to download the i.MX Yocto Project Community BSP\nrecipe layers. For this example, a directory called imx-yocto-bsp is created for the\nproject. Any name can be used instead of this."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"$ mkdir imx-yocto-bsp\n$ cd imx-yocto-bsp\n$ repo init -u https://github.com/nxp-imx/imx-manifest -b imx-linux-mickledore -m imx-6.1.22-2.0.0.xml\n$ repo sync\n"})}),"\n",(0,i.jsx)(t.h2,{id:"4building-the-project",children:"4.Building the Project"}),"\n",(0,i.jsx)(t.h3,{id:"41-change-uboot",children:"4.1 change uboot"}),"\n",(0,i.jsxs)(t.p,{children:["Replace the ",(0,i.jsx)(t.code,{children:"uboot"})," bb file before starting the build.\n",(0,i.jsx)(t.code,{children:"[your path]/imx-yocto-bsp/sources/meta-imx/meta-bsp/recipes-bsp/u-boot/u-boot-imx_2022.04.bb"})]}),"\n",(0,i.jsx)(t.p,{children:"before"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'\n# BEGIN: Changes to u-boot-imx-common_${PV}.inc\n\nLIC_FILES_CHKSUM = "file://Licenses/gpl-2.0.txt;md5=b234ee4d69f5fce4486a80fdaf4a4263"\n\nSRC_URI = "${UBOOT_SRC};branch=${SRCBRANCH}"\nUBOOT_SRC ?= "git://github.com/nxp-imx/uboot-imx.git;protocol=https"\nSRCBRANCH = "lf_v2022.04"\nSRCREV = "181859317bfafef1da79c59a4498650168ad9df6"\nLOCALVERSION = "-${SRCBRANCH}"\n\nDEPENDS += "gnutls-native xxd-native"\n\n'})}),"\n",(0,i.jsx)(t.p,{children:"after"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'# BEGIN: Changes to u-boot-imx-common_${PV}.inc\n\nLIC_FILES_CHKSUM = "file://Licenses/gpl-2.0.txt;md5=b234ee4d69f5fce4486a80fdaf4a4263"\n\nSRC_URI = "${UBOOT_SRC};branch=${SRCBRANCH}"\nUBOOT_SRC ?= "git://github.com/bit-brick/uboot-imx.git;protocol=https"\nSRCBRANCH = "lf_v2022.04"\nSRCREV = "2a29b5972b88343286ceda95b592c2f93a9c8bc4"\nLOCALVERSION = "-${SRCBRANCH}"\n\nDEPENDS += "gnutls-native xxd-native"\n\n'})}),"\n",(0,i.jsx)(t.h3,{id:"42-change-kernel",children:"4.2 change kernel"}),"\n",(0,i.jsxs)(t.p,{children:["Modify bb files:\n",(0,i.jsx)(t.code,{children:"[your path]/imx-yocto-bsp/sources/meta-imx/meta-bsp/recipes-kernel/linux/linux-imx_5.15.bb "}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"[your path]/imx-yocto-bsp/sources/meta-imx/meta-bsp/recipes-kernel/linux/linux-imx-headers_5.15.bb"})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'SRCBRANCH = "lf-5.15.y"\nLOCALVERSION = "-lts-next"\nKERNEL_SRC ?= "git://github.com/bit-brick/linux-imx.git;protocol=https;branch=${SRCBRANCH}"\nKBRANCH = "${SRCBRANCH}"\nSRC_URI = "${KERNEL_SRC}"\n\nSRCREV = "50912be386017c8d2ca7f0c9c0a32fa7ac84a283"\n\n'})}),"\n",(0,i.jsx)(t.p,{children:"then run code to build image"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"$ DISTRO=fsl-imx-wayland MACHINE=imx8mp-lpddr4-evk source imx-setup-release.sh -b build-wayland\n$ bitbake imx-image-full\n"})}),"\n",(0,i.jsx)(t.p,{children:"when it success, you will see the files in the build-wayland/tmp/deploy/images/imx8mp-lpddr4-evk  directory"}),"\n",(0,i.jsx)(t.h2,{id:"5burn-image-to-device",children:"5.Burn Image to device"}),"\n",(0,i.jsx)(t.h3,{id:"51-downloading-uuu",children:"5.1 Downloading UUU"}),"\n",(0,i.jsxs)(t.p,{children:["Download UUU version 1.4.193 or later from ",(0,i.jsx)(t.a,{href:"https://github.com/NXPmicro/mfgtools/releases",children:"https://github.com/NXPmicro/mfgtools/releases"}),"."]}),"\n",(0,i.jsx)(t.h3,{id:"52-using-uuu",children:"5.2 Using UUU"}),"\n",(0,i.jsx)(t.p,{children:"To use the UUU for  i.MX 8, follow the instructions below:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Connect a USB cable from a computer to the USB OTG/TYPE C port on the board."}),"\n",(0,i.jsx)(t.li,{children:"Connect a USB cable from the OTG-to-UART port to the computer for console output."}),"\n",(0,i.jsx)(t.li,{children:'Open a Terminal emulator program. See Section "Basic Terminal Setup" in this document.'}),"\n",(0,i.jsx)(t.li,{children:'Set the boot pin to serial download mode mode. See Section "Serial download mode for the Manufacturing Tool" in this\ndocument.\nTo use the UUU for i.MX 8ULP EVK, follow the instructions below:\n\u2022 To burn single-boot image and rootfs to eMMC, run the following command:'}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Switch the board pins to burn mode ",(0,i.jsx)(t.code,{children:"0 0 0 1"}),".\n",(0,i.jsx)(t.img,{src:n(6389).A+"",width:"1706",height:"1279"})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"sudo ~/bin/uuu -b emmc_all imx-boot-imx8mpevk-sd.bin-flash_evk imx-image-full-imx8mp-lpddr4-evk.wic.zst\n"})}),"\n",(0,i.jsxs)(t.p,{children:["After burning, switch the board pins to system running mode ",(0,i.jsx)(t.code,{children:"0 0 1 0"}),", then reset and reboot the system.\n",(0,i.jsx)(t.img,{src:n(701).A+"",width:"1706",height:"1279"}),"\nYou can also directly download the compiled image from the following link:",(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.a,{href:"https://drive.google.com/drive/folders/1DeiQxV0aQYxEGHuIq0V043Mfd73IX5uA?usp=drive_link",children:"imx-image-full-imx8mp-lpddr4-evk.wic.zst"})]}),"\n",(0,i.jsx)(t.h2,{id:"faq",children:"FAQ"}),"\n",(0,i.jsx)(t.h3,{id:"q-how-to-modify-the-number-of-threads",children:"Q: How to modify the number of threads?"}),"\n",(0,i.jsx)(t.p,{children:"A: Modify the number of threads in the build-dir/conf/local.conf file based on the performance of your computer."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:'# Choose your desired number of build threads\nBB_NUMBER_THREADS ?= "4"\n\n# Set the number of concurrent threads for make command\nPARALLEL_MAKE ?= "-j 4"\n'})}),"\n",(0,i.jsx)(t.h3,{id:"q-how-to-modify-the-size-of-the-tmp-partition",children:"Q: How to modify the size of the tmp partition?"}),"\n",(0,i.jsx)(t.p,{children:"A: Modify the size of the tmp partition in the build-dir/conf/local.conf file based on your requirements."}),"\n",(0,i.jsx)(t.h3,{id:"q-how-to-compile-the-kernel-separately",children:"Q: How to compile the kernel separately?"}),"\n",(0,i.jsx)(t.p,{children:"A: Run the following commands:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"bitbake -c cleanall virtual/kernel\nbitbake virtual/kernel\n"})}),"\n",(0,i.jsx)(t.h3,{id:"q-failure-in-installing-package-with-apt",children:"Q: Failure in installing package with apt"}),"\n",(0,i.jsxs)(t.p,{children:["A: Add ",(0,i.jsx)(t.code,{children:"[trusted=yes] "}),"in the source list and use date -e to change the system date."]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},6389:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/burn_status-fd43869c75d4ae32bec450c2b9a9a43f.jpg"},701:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/run_status-6cd989890e84ca8df2bdadc5719c9d61.jpg"},8453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>l});var i=n(6540);const o={},r=i.createContext(o);function s(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);